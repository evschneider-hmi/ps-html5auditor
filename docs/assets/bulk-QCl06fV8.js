const v=["plc","cmp","sid","ctx","advid","adsrv","campaign","placement","lineitem","lineitemid","bundle","creative","unit","pid","tagid"];function d(e){return/^https?:\/\//i.test(e.trim())}function m(e){const t=e.trim();return/^https?:\/\/.+\.(xml)(\?|#|$)/i.test(t)||/^https?:\/\//i.test(t)&&/vast|adtag|adtaguri/i.test(t)}function p(e){const t=e.trim();return t.startsWith("<")&&/<\s*VAST[\s>]/i.test(t)}function c(e){try{return new URL(e).host}catch{return""}}function f(e){const t=c(e).toLowerCase();return t?t.includes("doubleclick.net")||t.includes("googlesyndication.com")?"CM360":t.includes("innovid.com")||t.includes("rtr.innovid.com")||t.includes("dvrtr.innovid.com")?"Innovid":t.includes("doubleverify")||t.includes("dv.tech")?"DoubleVerify":t.split(".").slice(-2).join("."):"Other"}function A(e){const t=String(e||"").replace(/\r/g,"");let i=t.split(/\n/).map(n=>n.trim()).filter(Boolean);if(i.length<=1){const n=t.match(/https?:\/\/[^\s]+/gi)||[];n.length>1?i=n.map(s=>s.trim()):!i.length&&n.length===1&&(i=[n[0].trim()])}if(i.length<=1){const n=t.match(/<\s*VAST[\s\S]*?<\s*\/\s*VAST\s*>/gi)||[];n.length>1?i=n.map(s=>s.trim()):!i.length&&n.length===1&&(i=[n[0].trim()])}return i.map((n,s)=>{const o=p(n)?"VAST XML":m(n)?"VAST URL":d(n)?"Ad Tag":"Other",l=c(n),u=f(n),r={};try{new URL(n).searchParams.forEach((a,h)=>r[h]=a)}catch{}return{i:s+1,type:o,raw:n,host:l,vendor:u,params:r}})}export{v as H,A as p};
